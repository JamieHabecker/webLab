angular.module("KnowledgePortal",["ngResource","directives","dmvPortalConfig","globals","factories"]).config(["$routeProvider","$locationProvider","$httpProvider",function(a,b,c){c.defaults.headers.get={Accept:"application/json, text/javascript, */*"},a.when("/ContactUs",{controller:"StepOneController",templateUrl:"views/stepOne.html"}).when("/StepTwo",{controller:"StepTwoController",templateUrl:"views/stepTwo.html"}).when("/Verify",{controller:"VerifyController",templateUrl:"views/confirmation.html"}).when("/Complete",{controller:"CompleteController",templateUrl:"views/complete.html"}).otherwise({redirectTo:"/ContactUs"})}]).controller("StepOneController",["$scope","$location","$timeout",function(a,b,c){var d=sessionStorage.stepOne;if(sessionStorage.removeItem("vehicles"),d){var e=sessionStorage.getItem("stepOne"),f=JSON.parse(e),g={fillIt:function(){a.email=f.email,a.fn=f.firstname,a.lastname=f.lastname,a.phone=f.phone,a.subject=f.subject,a.customernumber=f.custnumber}};c(g.fillIt,100)}a.setText=function(a){var b=$("#sub option[value='"+a+"']").text();sessionStorage.subj=b},a.next=function(){_gaq.push(["_trackEvent","Contact Form Started!","ContactUs"]);var c={firstname:a.fn,lastname:a.lastname,phone:a.phone,email:a.email,subject:a.subject,custnumber:a.customernumber};"vi"===a.subject?(sessionStorage.vehicles=!0,sessionStorage.removeItem("complete")):"vi"!==a.subject&&sessionStorage.vehicleInfo&&sessionStorage.removeItem("vehicleInfo"),sessionStorage.setItem("stepOne",JSON.stringify(c)),sessionStorage.complete?b.path("/Verify"):b.path("/StepTwo")}}]).controller("StepTwoController",["$scope","$location","$timeout",function(a,b,c){if(sessionStorage.stepOne||b.path("/StepOne"),sessionStorage.vehicles&&(a.vehicles=!0),sessionStorage.vehicleInfo&&sessionStorage.description){var d=sessionStorage.getItem("vehicleInfo"),e=JSON.parse(d),f={fillIt:function(){a.details=sessionStorage.description,a.title=e.title,a.vvin=e.vin,a.vplate=e.plate}};c(f.fillIt,100)}else if(!sessionStorage.vehicleInfo&&sessionStorage.description){var f={fillIt:function(){a.details=sessionStorage.description}};c(f.fillIt,100)}a.next=function(){var c={title:a.title,vin:a.vvin,plate:a.vplate};sessionStorage.custnumber=a.customernumber,sessionStorage.description=a.details,sessionStorage.setItem("vehicleInfo",JSON.stringify(c)),b.path("/Verify")},a.back=function(){b.path("/StepOne")}}]).controller("VerifyController",["$scope","$location","ContactFactory",function(a,b,c){function d(){a.verify=!1,b.path("/Complete")}function e(b){a.err=b.status}var f,g,h,i,j={};if(a.dis=!0,a.verify=!0,sessionStorage.complete="yes",sessionStorage.vehicles?(a.vehicles=!0,a.vary="sing"):a.vary="sec",sessionStorage.stepOne||sessionStorage.stepTwo){f=sessionStorage.getItem("stepOne"),h=JSON.parse(f),j={firstname:h.firstname,lastname:h.lastname,phone:h.phone,email:h.email,suffix:h.suffix,subject:h.subject,realSubject:sessionStorage.subj,custnumber:h.custnumber,description:sessionStorage.description},sessionStorage.vehicleInfo&&(g=sessionStorage.getItem("vehicleInfo"),i=JSON.parse(g),j.title=i.title,j.vin=i.vin,j.plate=i.plate),"ot"===h.subject&&(j.realSubject=void 0),void 0!==h.phone&&-1!==h.phone.indexOf("555555")&&(j.phone=void 0),a.subj=sessionStorage.subj,a.mail=j.email,a.theData=[j];var k={oContactUsFields:j};a.addResponse=function(b){j.response=b,a.dis=!1}}else b.path("/StepOne");a.edit=function(a){console.log(a),b.path("/"+a)},a.next=function(){a.isloading=!0,sessionStorage.setItem("data",JSON.stringify(j)),c.contactInfo({},k,d,e)}}]).controller("CompleteController",["$scope","$location","$timeout",function(a,b,c){var d,e;sessionStorage.stepOne||sessionStorage.stepTwo||sessionStorage.data?(d=sessionStorage.getItem("data"),data=JSON.parse(d),a.theData=[data],_gaq.push(["_trackEvent","Contact Form Completed!","ContactUs"]),e={fillIt:function(){sessionStorage.clear()}},c(e.fillIt,1500)):b.path("/ContactUs"),a.next=function(){window.location.replace("/")}}]);var base="views/directiveTemplates/";angular.module("directives",[]).directive("placeholder",["$timeout",function(a){if(navigator.userAgent.indexOf("MSIE")<0)return{};if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var b=new Number(RegExp.$1);return b>10?void 0:{link:function(b,c,d){"password"!==d.type&&a(function(){c.val(d.placeholder).focus(function(){$(this).val()==$(this).attr("placeholder")&&$(this).val("")}).blur(function(){""==$(this).val()&&$(this).val($(this).attr("placeholder"))})})}}}}]).directive("button",function(){return{restrict:"E",compile:function(a){a.addClass("orgBtn")}}}).directive("custnumber",["$parse",function(a){return{restrict:"A",link:function(b){var c=$("input").attr("name");b.$watch(c,function(d){d&&-1!==d.indexOf("-")&&11===d.length&&a(c).assign(b,d.replace(/-/g,""))})}}}]),angular.module("dmvPortalConfig",[]).config(["$provide","$httpProvider","$compileProvider",function(a,b,c){var d;window.location.host;var e,f=$(),g=function(a,b,c,d){$("<h2>").addClass("message").addClass(b).appendTo(f).text(a)};b.responseInterceptors.push(["$timeout","$q","message","$location","$window",function(a,c,f,h){return function(a){var f=sessionStorage.id;return $("div.messagesList").length?($("div.messagesList").empty(),g("Loading...","loadingMessage",5e4)):g("Loading...","loadingMessage",5e4),a.then(function(c){if(c&&$("h2.loadingMessage").fadeOut(1040),d=c.headers("x-auth-token"),null!==d&&void 0!==d){e=c.headers("x-auth-token"),sessionStorage.id=e,credStore.push(e);var g=credStore.shift();b.defaults.headers.common={"X-Auth-Token":g},b.defaults.headers.common={Accept:"application/json, text/plain, * / *"}}return f&&(b.defaults.headers.get={Accept:"application/json, text/javascript, */*","X-Auth-Token":f},b.defaults.headers.post={Accept:"application/json, text/javascript, */*","Content-Type":"application/json; charset=utf-8","X-Auth-Token":f},b.defaults.headers.put={Accept:"application/json, text/javascript, */*","Content-Type":"application/json; charset=utf-8"}),a},function(a){var b=a.data;switch(a.status){case 404:$("div.messagesList").empty(),sessionStorage.clear(),g(b.STATUS,"errorMessage",2e4);break;case 500:$("div.messagesList").empty(),sessionStorage.clear(),g(b.STATUS,"errorMessage",2e4);break;default:g("Error "+a.status+": "+a.data,"errorMessage",2e4)}return c.reject(a)})}}]),c.directive("appMessages",function(){var a={restrict:"A",template:"<div></div>",replace:!0,link:function(a,b){f.push($(b))}};return a})}]),angular.module("factories",[]).factory("message",function(){return[]}).factory("ContactFactory",["$resource",function(a){var b="http://10.156.147.121:443:443/WebServicesBackEnd/ContactUs.aspx/SendFields";return a(b,{},{contactInfo:{method:"Post",url:b}})}]);